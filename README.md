# STView: An Eclipse plug-in Tool for Visualizing Program Structure in Fortran Source Codes

STView visualizes program structures in Fortran source codes on Eclipse to help performance engineers who try to improve their application on a supercomputer. STView has the following features.

* It can show a simplified tree that represents program structure based on abstract syntax tree generated by Photran.
* The simplified tree only includes loops, branches, and procedure calls because the structures usually contribute to the application performance.
* It supports Fortran 77, 90 and higher. (Photran supports Fortran 77-2008 as of Nov 2016.)
* It can import profiling data measured in the sample-based profiler for the Fujitsu FX10 supercomputer, and show it on Eclipse.

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig_overview.jpg" width="900" />
</kbd>

**NOTICE:**

* At this time, STView has been developing. It does not support directives (e.g., `#if`, `#ifdef`) and the `interface` statement in Fortran.
*  If you import Fortran source codes that include directives, those codes are required to be preprocessed before importing the codes on Eclipse.

At first release version of STView was developed by Ohichi Tomoyo and Mitsuo Yokokawa in Kobe University. Also, this project was conducted in collaboration with Masaaki Terai and Kazuo Minami in RIKEN.

## Preliminaries

STView requires the following environment.

* Java Runtime Environment version 1.8
* Eclipse version 4.4.1 or later (code name: Mars, Neon)
* Photran version 9.0.1

If you would like to build STView from source codes, PDE is required in addition to the above.

* Eclipse Plugin Development Environment (PDE)

## Quick Start

First, you can open the Install dialogue in "Help" -> "Install New Software" from the menu on Eclipse. After that, you fill in the following URL on the "Work with:" then you can see the STView item in the list.

http://www.aics.riken.jp/ungi/soft/stview/feature/

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig_install.jpg" width="500" />
</kbd>

## Build STView

You can build STView along with the following steps.

* At first, you clone this repository.

```
$ git clone https://github.com/K-scope/STView
```

* To create a new plug-in project, you choose the project wizard from the menu on Eclipse.
In the first step of the wizard dialog, you choose "Plug-in Project" as a project type, and then press the next button.

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig1.jpg" width="500" />
</kbd>

* You set the "Project name" and press the next button.
At this time, if the "Create a Java project" box is already checked, you uncheck the item.

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig2.jpg" width="500" />
</kbd>

* Just press the finish button.

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig3.jpg" width="500" />
</kbd>

* After completion of the new project setup, you launch the popup menu on the project folder icon in the "Package Explorer", and then choose the "import."

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig5.jpg" width="300" />
</kbd>

* Next, you choose "File System" in the dialog, and then press the next button.

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig6.jpg" width="500" />
</kbd>

* In the dialog, you set the STView folder that was cloned by git.
Make sure you check the all items, and then press the finish button.

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig7.jpg" width="500" />
</kbd>

You finish all the settings of the build environment.

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig8.jpg" width="900" />
</kbd>

To package and export plug-in, you click "build.properties" in the package explorer and choose "Export Wizard" in the Exporting.

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig11.jpg" width="900" />
</kbd>

You copy the created jar file to the plug-in directory (e.g., ${ECLIPSE_HOME}/plugins), and then reboot Eclipse.
After that, you can see new tool icons in "Window" -> "Show View" -> "Other..." from the menu on Eclipse.

<kbd>
<img src="http://www.aics.riken.jp/ungi/soft/stview/materials/fig12.jpg" width="500" />
</kbd>

## Usage Instructions (summary)

You can show the program structure along with the following steps.

* Launch Eclipse and create a new Fortran project
* Import source codes to the created project
* Open a file in the editor
* Show the tree view from the menu bar
* Click the icon (tree icon) on the tree view, and then start a tree construction
* Completion of the construction, drawing a tree on the tree view
* Each node of the links correspondent a part of source code (e.g., subroutine, function and line of code) and show them on the editor.

## Publications

[Ohichi Tomomi, Masaaki Terai, Mitsuo Yokokawa, Kazuo Minami, "STView: An Eclipse Plug-in Tool for Visualizing Program Structures in Fortran Source Codes," Technical Program Posters in SC16.](http://sc16.supercomputing.org/sc-archive/tech_poster/tech_poster_pages/post175.html)

## License

STView is released under the Eclipse Public License 1.0.

Copyright 2016 Ohichi Tomomi, Mitsuo Yokokawa and RIKEN.

Licensed under the Eclipse Public License 1.0 (EPL-1.0 or the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.eclipse.org/org/documents/epl-v10.php

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

This product includes the following software placed into the lib directory.

* [PDF-renderer](https://github.com/katjas/PDFrenderer) (covered by LGPL-2.1)
* [iText](https://github.com/weiyeh/iText-4.2.0) (covered by MPL/LGPL) 
